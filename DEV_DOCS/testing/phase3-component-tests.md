# Phase 3: 组件与配置 (L3 — 组件测试)

> **预计工时:** 1 天 | **优先级:** P2 | **前置条件:** Phase 1 通过，Phase
> 2 品牌替换验证通过 **负责人:** \***\*\_\_\_\_\*\*** |
> **执行日期:** \***\*\_\_\_\_\*\***

---

## 测试目的

验证 UI 组件、Slash 命令、配置系统的交互行为。

---

## 环境准备

- [ ] Phase 1 构建验证已通过
- [ ] Phase 2 品牌替换验证（L2-01~L2-08）已通过
- [ ] `GEMINI_API_KEY` 和/或 `ZHIPU_API_KEY` 已配置
- [ ] `~/.isqcoder/settings.json` 已正确配置

---

## 4.3.1 认证流程

| 编号  | 测试项          | 验证方法                  | 预期结果                                      | 状态 | 实际结果 | 备注 |
| ----- | --------------- | ------------------------- | --------------------------------------------- | ---- | -------- | ---- |
| L3-01 | AuthDialog 展示 | 渲染 AuthDialog 组件      | 显示 Gemini API Key 和 Zhipu API Key 两个选项 | 🔲   |          |      |
| L3-02 | Gemini API 认证 | 输入有效 `GEMINI_API_KEY` | 认证成功，进入主界面                          | 🔲   |          |      |
| L3-03 | Zhipu API 认证  | 输入有效 `ZHIPU_API_KEY`  | 认证成功，进入主界面                          | 🔲   |          |      |
| L3-04 | 无效 Key 处理   | 输入无效 API Key          | 显示友好错误信息，允许重试                    | 🔲   |          |      |
| L3-05 | 非交互模式认证  | 通过环境变量预设 Key 启动 | 跳过认证对话框，直接进入                      | 🔲   |          |      |

## 4.3.2 量子 Slash 命令

| 编号  | 测试项                 | 验证方法                                  | 预期结果                                 | 状态 | 实际结果 | 备注 |
| ----- | ---------------------- | ----------------------------------------- | ---------------------------------------- | ---- | -------- | ---- |
| L3-06 | `/qrun` 命令注册       | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-07 | `/qfix` 命令注册       | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-08 | `/qpy` 命令注册        | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-09 | `/qsearch` 命令注册    | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-10 | `/qtemplate` 命令注册  | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-11 | `/qenv` 命令注册       | 检查 BuiltinCommandLoader                 | 命令已注册，help 文本正确                | 🔲   |          |      |
| L3-12 | Tab 补全 — `.isq` 文件 | 在含 `.isq` 文件的目录中触发 `/qrun` 补全 | 列出当前目录所有 `.isq` 文件             | 🔲   |          |      |
| L3-13 | Tab 补全 — `.py` 文件  | 在含 `.py` 文件的目录中触发 `/qpy` 补全   | 列出当前目录所有 `.py` 文件              | 🔲   |          |      |
| L3-14 | `/qtemplate` 模板列表  | 不带参数执行 `/qtemplate`                 | 列出所有可用模板（bell, ghz, grover 等） | 🔲   |          |      |
| L3-15 | 缺少参数提示           | 执行 `/qrun`（不带文件名）                | 显示使用说明而非崩溃                     | 🔲   |          |      |

## 4.3.3 配置系统

| 编号  | 测试项             | 验证方法                         | 预期结果                     | 状态 | 实际结果 | 备注 |
| ----- | ------------------ | -------------------------------- | ---------------------------- | ---- | -------- | ---- |
| L3-16 | settings.json 加载 | 读取 `~/.isqcoder/settings.json` | 正确解析 MCP Server 配置     | 🔲   |          |      |
| L3-17 | MCP Server 配置    | 配置 `mcpServers.isqcoder` 段    | 识别 isQCodeAgent MCP Server | 🔲   |          |      |
| L3-18 | 扩展管理           | 通过 extension-manager 加载扩展  | 扩展加载不影响核心功能       | 🔲   |          |      |
| L3-19 | ISQCODER.md 加载   | 在项目目录放置 `ISQCODER.md`     | 内容被注入到上下文中         | 🔲   |          |      |
| L3-20 | 文件夹信任机制     | 首次进入新目录                   | 弹出信任确认提示             | 🔲   |          |      |

## 4.3.4 UI 展示

| 编号  | 测试项       | 验证方法                  | 预期结果                     | 状态 | 实际结果 | 备注 |
| ----- | ------------ | ------------------------- | ---------------------------- | ---- | -------- | ---- |
| L3-21 | 启动画面     | 运行 `isqcoder`           | 显示 isQCoder ASCII Art 标志 | 🔲   |          |      |
| L3-22 | 帮助信息     | 运行 `isqcoder --help`    | 显示 isQCoder 相关的帮助信息 | 🔲   |          |      |
| L3-23 | 版本信息     | 运行 `isqcoder --version` | 显示正确的版本号             | 🔲   |          |      |
| L3-24 | Tips 展示    | 观察启动后的 Tips         | 包含量子计算相关提示         | 🔲   |          |      |
| L3-25 | isQ 代码渲染 | 在对话中生成 isQ 代码块   | 代码带有语法高亮着色         | 🔲   |          |      |

---

## 测试结果汇总

| 编号  | 状态 | 编号  | 状态 | 编号  | 状态 |
| ----- | ---- | ----- | ---- | ----- | ---- |
| L3-01 | 🔲   | L3-10 | 🔲   | L3-19 | 🔲   |
| L3-02 | 🔲   | L3-11 | 🔲   | L3-20 | 🔲   |
| L3-03 | 🔲   | L3-12 | 🔲   | L3-21 | 🔲   |
| L3-04 | 🔲   | L3-13 | 🔲   | L3-22 | 🔲   |
| L3-05 | 🔲   | L3-14 | 🔲   | L3-23 | 🔲   |
| L3-06 | 🔲   | L3-15 | 🔲   | L3-24 | 🔲   |
| L3-07 | 🔲   | L3-16 | 🔲   | L3-25 | 🔲   |
| L3-08 | 🔲   | L3-17 | 🔲   |       |      |
| L3-09 | 🔲   | L3-18 | 🔲   |       |      |

**通过率:** _/25 ( _%)

---

## 阻塞问题记录

| #   | 问题描述 | 影响范围 | 严重程度 | 状态 |
| --- | -------- | -------- | -------- | ---- |
|     |          |          |          |      |

---

## 签字确认

- **测试执行人:** \***\*\_\_\_\_\*\***
- **完成日期:** \***\*\_\_\_\_\*\***
- **结论:** ☐ 全部通过，可进入 Phase 4 / ☐ 存在阻塞问题，需修复后重测
